---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCaseStudies } from '../../lib/content';

export async function getStaticPaths() {
  const caseStudies = await getCaseStudies();
  
  return caseStudies.map((study) => ({
    params: { slug: study.slug },
    props: { study },
  }));
}

interface Props {
  study: any;
}

const { study } = Astro.props as Props;
const base = import.meta.env.BASE_URL?.replace(/\/$/, '') || '';

---

<BaseLayout title={`${study.title} â€“ Case Study`} current="case-studies">
  <article class="max-w-4xl mx-auto px-5 lg:px-8 py-12 pb-16">
    <div class="mb-6">
      <a href={`${base}/case-studies`} class="text-muted hover:text-off-white transition-colors inline-flex items-center gap-1.5 text-sm">
        <svg width="14" height="14" fill="none" viewBox="0 0 16 16" stroke="currentColor" stroke-width="2">
          <path d="M10 13l-5-5 5-5" />
        </svg>
        Back to Case Studies
      </a>
    </div>
    
    <h1 class="text-[clamp(2rem,4vw,3rem)] leading-tight font-semibold mb-4 bg-gradient-to-r from-off-white to-muted bg-clip-text text-transparent">
      {study.title}
    </h1>
    
    <div class="flex flex-wrap gap-2 mb-6">
      {study.technologies.map((tech) => (
        <span class="px-3 py-1 bg-surface border border-border rounded-full text-sm text-muted">
          {tech}
        </span>
      ))}
    </div>
    
    <div class="bg-surface/40 border border-border rounded-lg p-5 mb-8">
      <dl class="grid gap-4">
        <div>
          <dt class="text-muted text-xs uppercase tracking-wider mb-1">Role</dt>
          <dd class="text-off-white">{study.role}</dd>
        </div>
        <div>
          <dt class="text-muted text-xs uppercase tracking-wider mb-1">Outcomes</dt>
          <dd class="text-off-white text-sm">{study.outcomes}</dd>
        </div>
      </dl>
    </div>
    
    <div class="prose prose-invert prose-lg max-w-none mb-8 text-off-white/90">
      <div set:html={study.body} />
    </div>
    
    {study.links && study.links.length > 0 && (
      <div class="flex gap-3">
        {study.links.map((link) => (
          <a
            href={link.url}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center justify-center px-[1.1rem] py-2 rounded-full bg-off-white text-off-black text-[0.85rem] font-medium transition-all hover:bg-white"
          >
            {link.label}
          </a>
        ))}
      </div>
    )}
  </article>
</BaseLayout>
